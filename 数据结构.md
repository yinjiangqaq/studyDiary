## 平衡树

平衡树(Balance Tree，BT) 指的是，任意节点的子树的高度差都小于等于 1。常见的符合平衡树的有，B 树（多路平衡搜索树）、AVL 树（二叉平衡搜索树）等。

在数据库的时候，用到红黑树这样的平衡树会用的多，因为要建立索引

## 最大堆

```js
const defaultCmp = (x, y) => x > y;
const swap = (arr, i, j) => ([arr[i], arr[j]] = [arr[j], arr[i]]);

class Heap {
  constructor(cmp = defaultCmp) {
    this.container = [];
    this.cmp = cmp;
  }
  //自底向上回溯
  insert(data) {
    const { container, cmp } = this;
    container.push(data);
    let index = container.length - 1;
    while (index) {
      let parent = (index - 1) >> 1;
      if (!cmp(container[index], container[parent])) {
        return;
      } else {
        swap(container[index], container[parent]);
        index = parent;
      }
    }
  }
  //自顶向下回溯
  extract() {
    const { container, cmp } = this;
    if (!container.length) {
      return null;
    }
    swap(container, 0, container.length - 1); //交换位置,删除栈顶元素
    const res = container.pop();
    const length = container.length;
    let index = 0,
      exchange = index * 2 + 1;
    while (exchange > index) {
      let right = index * 2 + 2;
      if (right < length && cmp(container[right], container[exchange])) {
        exchange = right;
      }
      if (!cmp(container[exchange], container[index])) {
        break;
      }
      swap(container, exchange, index);
      index = exchange;
      exchange = index * 2 + 1;
    }
  }
  top() {
    if (this.container.length) {
      return this.container[0];
    }
    return null;
  }
}
```
